---
redirect_from: /ru/CygwinHeap.html
---

<!-- Content starts -->

<p>When you run any application compiled with cygwin or msys (that is statically linked with cygwin1.dll or msys???.dll) you may, sometimes, notice weird error in application console output, and it will immediately exits after that. </p>
<pre class="prettyprint">0 [main] us 0 init_cheap: VirtualAlloc pointer is null, Win32 error 487 AllocationBase 0x68520000, BaseAddress 0x68570000, RegionSize 0x218000, State 0x1000 C:\Program Files (x86)\Git\bin\ls.exe: *** Couldn&#x27;t reserve space for cygwin&#x27;s heap, Win32 error 487</pre>
<p>That is known cygwin problem mentioned in their FAQ (link?) </p>
<p>And what does that error means? Cygwin (or msys) initialization routine tries to allocate memory (relatively large amount) at the <strong></strong>fixed<strong></strong> address. And, yep, it is already used by some dll! </p>
<p>Is that a ConEmu problem? </p>
<p>No! </p>
<p>1) ConEmu is aware about cygwin and msys requirements and <a href="ConEmuHk.html">ConEmuHk</a> compiled with link options ask Windows kernel to load <a href="ConEmuHk.html">ConEmuHk</a>.dll (or ConEmuHk64.dll) in the memory address which must not has conflicts with cygwin or msys. 2) There is no one bug report which confirm conflict between ConEmu and cygwin/msys. </p>

<h1 id="h0"><a name="How_to_fix_that?"></a>How to fix that?<a href="#How_to_fix_that?" class="section_anchor"></a></h1>
<p>I really can&#x27;t help you because it is not a ConEmu bug... But you may fix it yourself in your PC. 1) First of all, try to logoff/logon. If same here - try to restart your PC. 2) Same here? That means you must find problematic dll. Use ConEmuReportExe environment variable to stop execution of your application (sh.exe, ls.exe, and so on). And when message box arrears &quot;sh.exe loaded&quot; use <a href="ProcessMonitor.html">ProcessMonitor</a> to find dll which was loaded immediately after cygwin1.dll or msys???.dll. Press OK in the waiting message box and confirm that &quot;failed&quot; allocation memory address overlaps with dll your found. From my experience, that can be &quot;<a href="AppHelp.html">apphelp.dll</a>&quot;. When you find bad gay: a) You may to PATCH this dll. Use rebase tool from Windows sdk for example. What new base address to choose? I can&#x27;t tell you. Ideally, that address must not overlaps with any other libraries... but there are thousands... Good thing - must of them can be linked with dynamic base, bad thing - off you choose bad address, your system will be unstable (error code 0xC???). b) And, if it possible, you may install the program which had installed that dll c) Also, may be that program allows to set up exclusions. If you are working in the ConEmu consoles only, you may add to exclusions list only ConEmu&#x27;s executables (ConEmuC.exe, ConEmuC64.exe, ConEmu.exe, ConEmu64.exe). Otherwise, you need to add to exclusions list all of your cygwin/msys applications (sh, ls, and on). </p>

<h1><a name="Still_not_sure?"></a>Still not sure?<a href="#Still_not_sure?" class="section_anchor"></a></h1>
<p>Well, submit your report with <a href="MemoryDump.html">MiniDump</a> attached. All reports will be checked. </p>

<h1><a name="How_to_create_required_dump"></a>How to create required dump<a href="#How_to_create_required_dump" class="section_anchor"></a></h1>
<p>Run your cmd prompt set ConEmuReportExe=ls.exe ls </p>
<p>Message box must appears &quot;ls.exe loaded&quot; At this time, call ConEmu system menu &gt; Debug &gt; Active process memory dump Attach here <a href="MemoryDump.html">MiniDump</a> (full dump is not required) </p>
<p>After pressing OK in &quot;loaded&quot; message box your error message expected. </p>

<!-- Content ends -->
